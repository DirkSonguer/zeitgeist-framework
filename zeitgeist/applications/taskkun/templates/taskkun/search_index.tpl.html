<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/taskkun.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- InstanceBeginEditable name="doctitle" -->
<title>Taskkun - @@{documenttitle}@@</title>
<!-- InstanceEndEditable -->

<link rel="stylesheet" type="text/css" href="@@{templatepath}@@/css/taskkun.css" />
<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/js/common.js"></script>
	
<!-- InstanceBeginEditable name="head" -->

	<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryData.js"></script>
	<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/Spry/xpath.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryNestedXMLDataSet.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryCollapsiblePanel.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/js/SpryExtensions.js"></script>

	<script type="text/javascript">

		var dsResults = new Spry.Data.XMLDataSet("@@{[dataserver.searchtasks]}@@", "container/element", { useCache: false });
		dsResults.setColumnType("task_id", "number");
		dsResults.setColumnType("task_hoursplanned", "number");
		dsResults.setColumnType("task_hoursworked", "number");

		var dsTags = new Spry.Data.XMLDataSet("@@{[dataserver.getalltags]}@@", "container/element", { useCache: false });
		dsTags.setColumnType("tag_id", "number");
		dsTags.setColumnType("tag_count", "number");
		
		function updateSearch()
		{
			currentSearch = document.getElementById('searchinput').value;
			
			var spryURL = "@@{[dataserver.searchtasks]}@@&searchterms="+currentSearch;
			dsResults.url = spryURL;
			dsResults.loadData();
			
			return false;
		}

		function addTag(tagText)
		{
			currentSearch = document.getElementById('searchinput').value;
			
			if (currentSearch != '')
			{
				currentSearch += ' ';
			}
			
			currentSearch += tagText;
			document.getElementById('searchinput').value = currentSearch;
			
			updateSearch();
		}

	</script>

<!-- InstanceEndEditable -->
</head>

<body>

<div id="Tooltip" class="tooltip" style="display:none; text-align:left;"></div>

<div class="headmenu">
	<!-- TemplateBeginBlock name="logoutbutton" -->
	<div class="menuicon" style="float:right; margin-top:5px;">
	
	<a href="@@{[configuration.index]}@@"><span onmousemove="showTooltip('Persönliche Einstellungen', event)" onmouseout="hideTooltip()">
	<img src="@@{templatepath}@@/nuvola/48x48/apps/kcmsystem.png" alt="" border="0" /></span></a>
	
	<a href="@@{[help.index]}@@@@{helptopic}@@" target="_blank"><span onmousemove="showTooltip('Hilfe', event)" onmouseout="hideTooltip()">
	<img src="@@{templatepath}@@/nuvola/48x48/apps/filetypes.png" alt="" border="0" /></span></a>	

	<a href="@@{[main.logout]}@@"><span onmousemove="showTooltip('Logout', event)" onmouseout="hideTooltip()">
	<img src="@@{templatepath}@@/nuvola/48x48/actions/exit.png" alt="" border="0" /></span></a>
	
	</div>
	<!-- TemplateEndBlock -->
</div>

<div class="maincontent">

<!-- TemplateBeginBlock name="navigation" -->
	<div class="headerbox">
		<div style="float:left; margin:10px;"><a href="@@{[main.index]}@@"><span onmousemove="showTooltip('Hauptseite', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/actions/gohome.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasks.index]}@@"><span onmousemove="showTooltip('Eigene Aufgaben', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/klipper.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[adhoc.index]}@@"><span onmousemove="showTooltip('Ad-Hoc-Tätigkeit eintragen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/karm.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[reports.index]}@@"><span onmousemove="showTooltip('Reports', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kchart.png" alt="" border="0" /></span></a></div>		
		
		<!-- TemplateBeginBlock name="managernavigation" -->
		<div style="float:left; margin:10px; margin-left:40px;"><a href="@@{[tasks.addtask]}@@"><span onmousemove="showTooltip('Neue Aufgabe anlegen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kword.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasks.showactivetasks]}@@"><span onmousemove="showTooltip('Alle aktiven Aufgaben anzeigen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kpager.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[search.index]}@@"><span onmousemove="showTooltip('Aktive Aufgaben suchen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kpdf.png" alt="" border="0" /></span></a></div>
		<!-- TemplateEndBlock -->

		<!-- TemplateBeginBlock name="adminnavigation" -->
		<div style="float:left; margin:10px; margin-left:40px;"><a href="@@{[users.index]}@@"><span onmousemove="showTooltip('Benutzer verwalten', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kdmconfig.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[groups.index]}@@"><span onmousemove="showTooltip('Gruppen verwalten', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/katomic.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasktypes.index]}@@"><span onmousemove="showTooltip('Aufgabenabläufe verwalten', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kalzium.png" alt="" border="0" /></span></a></div>
		<!-- TemplateEndBlock -->
		
		<div style="clear:both"></div>
	</div>
<!-- TemplateEndBlock -->

<!-- InstanceBeginEditable name="pagetitle" -->
<!-- InstanceEndEditable -->

	<!-- TemplateBeginBlock name="usermessage" -->
		<h3 class="usermessage"><img src="@@{templatepath}@@/nuvola/16x16/actions/ok.png" alt="" align="left" style="margin-right:5px;" /> @@{usermessage}@@</h3>
	<!-- TemplateEndBlock -->

	<!-- TemplateBeginBlock name="userwarnings" -->
		<h3 class="userwarning"><img src="@@{templatepath}@@/nuvola/16x16/actions/messagebox_info.png" alt="" align="left" style="margin-right:5px;" /> @@{userwarning}@@</h3>
	<!-- TemplateEndBlock -->

	<!-- TemplateBeginBlock name="usererrors" -->
		<h3 class="usererror"><img src="@@{templatepath}@@/nuvola/16x16/actions/no.png" alt="" align="left" style="margin-right:5px;" /> @@{usererror}@@</h3>
	<!-- TemplateEndBlock -->
	
<!-- InstanceBeginEditable name="body" -->

<form action="#" onsubmit="return updateSearch()">
<div class="textbox">
<h2>Aufgaben suchen</h2>

<table border="0" cellpadding="0" cellspacing="10">
	<tr>
		<td align="right" nowrap="nowrap" valign="top" width="140"><p class="formlabel">Suchbegriffe</p></td>
		<td align="left" nowrap="nowrap" valign="middle">
			<input maxlength="512" style="width:750px; margin-top:10px;" name="searchinput" id="searchinput" value="@@{searchterms}@@" class="formtext" type="text" />
		</td>
	</tr>
	<tr>
	<td colspan="2">
		<p style="text-align:center;"><img src="@@{templatepath}@@/nuvola/32x32/apps/kpdf.png" alt="" border="0" align="top" />
		<input name="submitSearch" class="formbutton" value="Aufgaben suchen" type="submit" onclick="updateSearch()" /></p>
	</td>
	</tr>
</table>

</div>

<div id="TagCloud" class="CollapsiblePanel, textbox">
	<div class="CollapsiblePanelTab">
		<h2 style="text-align:left; background:#B5BD82; padding:5px;">Suche mit Tags
		<span style="float:right; margin-top:-20px;"><img src="@@{templatepath}@@/nuvola/22x22/actions/1uparrow.png" alt="" name="groupIcon" align="left" border="0" /><img src="@@{templatepath}@@/nuvola/22x22/actions/1downarrow.png" alt="" name="groupIcon" align="left" border="0" /></span>
		</h2>
	</div>

	<div class="CollapsiblePanelContent">
		<div spry:region="dsTags">
			<div spry:state="loading"><p style="text-align:center;"><img src="@@{templatepath}@@/images/loading.gif" alt="" /></p></div>
		
			<div spry:state="ready">
			<p style="text-align:center;">
				<a spry:repeat="dsTags" href="javascript:addTag('{dsTags::tag_text}')" style="margin-left:5px; margin-right:5px;" class='tag{dsTags::tag_score}'>{dsTags::tag_text}</a>
			</p>
			<div style="clear:both;"></div>
			</div>
			<br />
		</div>
	</div>
</div>

</form>

<div class="textbox">
	<h2>Suchergebnisse</h2>
	<div style="clear:both"></div>

	<div spry:region="dsResults">
    <div spry:state="loading"><p style="text-align:center;"><img src="@@{templatepath}@@/images/loading.gif" alt="" /></p></div>

	<div spry:state="ready">
	    <table border="0" cellspacing="0" cellpadding="0" width="100%">
	        <tr class="tablehead">
				<th><p><a onclick="dsResults.sort('task_name');" class="sortlink">Aufgabe</a></p></th>
				<th><p><a onclick="dsResults.sort('group_name');" class="sortlink">Verantwortlich</a></p></th>
				<th><p style="text-align:center;"><a onclick="dsResults.sort('task_end');" class="sortlink">Fällig am</a></p></th>
				<th><p class="thtext">Aktionen</p></th>
	        </tr>
	        <tr class="{ds_EvenOddRow}" spry:repeat="dsResults">
				<td><p><span onmousemove="showTooltip('{dsResults::task_description}', event)" onmouseout="hideTooltip()">{dsResults::task_name}</span></p></td>
				<td>
					<div spry:choose="spry:choose">
						<div spry:when="'{dsResults::user_username}' == ''"><p>{dsResults::group_name}</p></div>
						<div spry:default="spry:default">
							<p>{dsResults::user_username}</p>
						</div>
					</div>
				</td>
				<td>
					<div spry:choose="spry:choose">
						<div spry:when="'{dsResults::task_end}' == '00.00.0000'"><p style="text-align:center;">-</p></div>
						<div spry:default="spry:default">
							<p style="text-align:center;">{dsResults::task_end}</p>
						</div>
					</div>
				</td>
				<td width="120"><p style="text-align:center;">
				<span onmousemove="showTooltip('Details', event)" onmouseout="hideTooltip()"><a href="@@{[tasks.taskdetails]}@@&id={dsResults::task_id}" alt="Details"><img src="@@{templatepath}@@/nuvola/22x22/apps/kappfinder.png" alt="Details" border="0" /></a></span> &nbsp; 
				<span onmousemove="showTooltip('Aufgabe bearbeiten', event)" onmouseout="hideTooltip()"><a href="@@{[tasks.edittask]}@@&id={dsResults::task_id}" alt="Aufgabe bearbeiten"><img src="@@{templatepath}@@/nuvola/22x22/apps/kate.png" alt="Aufgabe bearbeiten" border="0" /></a></span> &nbsp; 
				<span onmousemove="showTooltip('Aufgabe löschen', event)" onmouseout="hideTooltip()"><a href="javascript:deleteTask({dsResults::task_id}, '{dsResults::task_name}')" alt="Aufgabe löschen"><img src="@@{templatepath}@@/nuvola/22x22/filesystems/trashcan_full.png" alt="Aufgabe löschen" border="0" /></a></span>
                </p></td>
	        </tr>
	    </table>
    </div>
	</div>
	
</div>

<script type="text/javascript">
	var TagCloud = new Spry.Widget.CollapsiblePanel("TagCloud", {contentIsOpen:false});
</script> 

<!-- InstanceEndEditable -->

</div>
<div class="copyright">@@{versioninfo}@@</div>

</body>
<!-- InstanceEnd --></html>
