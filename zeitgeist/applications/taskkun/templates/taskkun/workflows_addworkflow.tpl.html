<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/taskkun.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- InstanceBeginEditable name="doctitle" -->
<title>Taskkun - @@{documenttitle}@@</title>
<!-- InstanceEndEditable -->

<link rel="stylesheet" type="text/css" href="@@{templatepath}@@/css/taskkun.css" />
<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/js/common.js"></script>
	
<!-- InstanceBeginEditable name="head" -->

	<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryData.js"></script>
	<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/Spry/xpath.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryNestedXMLDataSet.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/js/SpryExtensions.js"></script>

	<script type="text/javascript">

		var dsWorkflowInformation = new Spry.Data.XMLDataSet("@@{[workflows.editworkflowinformation]}@@&id=@@{workflow_id}@@", "container/element", {useCache: false });
		var dsGroupInformation = new Spry.Data.XMLDataSet("@@{[dataserver.getgroups]}@@", "container/element");

		function updateWorkflow(formaction, formvalue)
		{
			var formdata = '';
			
			if (formaction == 'storedata')
			{
				var inputdata = document.getElementById('inputfield_'+formvalue).value;
				var dropdowndata = document.getElementById('dropdownfield_'+formvalue).value;
				formdata = "&inputdata=" + inputdata + "&dropdowndata=" + dropdowndata;
			}
			
			var spryURL = "@@{[workflows.editworkflowinformation]}@@&id=@@{workflow_id}@@&formaction=" + formaction + "&formvalue=" + formvalue + formdata;
			dsWorkflowInformation.url = spryURL;
			dsWorkflowInformation.loadData();

			return true;
		}

		function deleteStep(id, name)
		{
			var answer = window.confirm("Wollen Sie den Aufgabenschritt " + id + " ('" + name + "') wirklich löschen?");

			if (answer == true)
			{
				updateWorkflow('deletestep', id);
			}
		}

	</script>

<!-- InstanceEndEditable -->
</head>

<body>

<div id="Tooltip" class="tooltip" style="display:none; text-align:left;"></div>

<div class="headmenu">
	<!-- TemplateBeginBlock name="logoutbutton" -->
	<div class="menuicon" style="float:right; margin-top:5px;">
	
	<a href="@@{[configuration.index]}@@"><span onmousemove="showTooltip('Persönliche Einstellungen', event);" onmouseout="hideTooltip();">
	<img src="@@{templatepath}@@/nuvola/48x48/apps/kcmsystem.png" alt="" border="0" /></span></a>
	
	<a href="@@{[help.index]}@@@@{helptopic}@@" target="_blank"><span onmousemove="showTooltip('Hilfe', event);" onmouseout="hideTooltip();">
	<img src="@@{templatepath}@@/nuvola/48x48/apps/filetypes.png" alt="" border="0" /></span></a>	

	<a href="@@{[main.logout]}@@"><span onmousemove="showTooltip('Logout', event);" onmouseout="hideTooltip();">
	<img src="@@{templatepath}@@/nuvola/48x48/actions/exit.png" alt="" border="0" /></span></a>
	
	</div>
	<!-- TemplateEndBlock -->
</div>

<div class="maincontent">

<!-- TemplateBeginBlock name="navigation" -->
	<div class="headerbox">
		<div style="float:left; margin:10px;"><a href="@@{[main.index]}@@"><span onmousemove="showTooltip('Hauptseite', event);" onmouseout="hideTooltip();">
		<img src="@@{templatepath}@@/nuvola/48x48/actions/gohome.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasks.index]}@@"><span onmousemove="showTooltip('Eigene Aufgaben', event);" onmouseout="hideTooltip();">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/klipper.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[adhoc.index]}@@"><span onmousemove="showTooltip('Ad-Hoc-Tätigkeit eintragen', event);" onmouseout="hideTooltip();">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/karm.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[reports.index]}@@"><span onmousemove="showTooltip('Reports', event);" onmouseout="hideTooltip();">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kchart.png" alt="" border="0" /></span></a></div>		
		
		<!-- TemplateBeginBlock name="managernavigation" -->
		<div style="float:left; margin:10px; margin-left:40px;"><a href="@@{[tasks.addtask]}@@"><span onmousemove="showTooltip('Neue Aufgabe anlegen', event);" onmouseout="hideTooltip();">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kword.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasks.showactivetasks]}@@"><span onmousemove="showTooltip('Alle aktiven Aufgaben anzeigen', event);" onmouseout="hideTooltip();">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kpager.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[search.index]}@@"><span onmousemove="showTooltip('Aktive Aufgaben suchen', event);" onmouseout="hideTooltip();">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kpdf.png" alt="" border="0" /></span></a></div>
		<!-- TemplateEndBlock -->

		<!-- TemplateBeginBlock name="adminnavigation" -->
		<div style="float:left; margin:10px; margin-left:40px;"><a href="@@{[users.index]}@@"><span onmousemove="showTooltip('Benutzer verwalten', event);" onmouseout="hideTooltip();">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kdmconfig.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[groups.index]}@@"><span onmousemove="showTooltip('Gruppen verwalten', event);" onmouseout="hideTooltip();">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/katomic.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[workflows.index]}@@"><span onmousemove="showTooltip('Aufgabenabläufe verwalten', event);" onmouseout="hideTooltip();">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kalzium.png" alt="" border="0" /></span></a></div>
		<!-- TemplateEndBlock -->
		
		<div style="clear:both"></div>
	</div>
<!-- TemplateEndBlock -->

<!-- InstanceBeginEditable name="pagetitle" -->
<!-- InstanceEndEditable -->

	<!-- TemplateBeginBlock name="usermessage" -->
		<h3 class="usermessage"><img src="@@{templatepath}@@/nuvola/16x16/actions/ok.png" alt="" align="left" style="margin-right:5px;" /> @@{usermessage}@@</h3>
	<!-- TemplateEndBlock -->

	<!-- TemplateBeginBlock name="userwarnings" -->
		<h3 class="userwarning"><img src="@@{templatepath}@@/nuvola/16x16/actions/messagebox_info.png" alt="" align="left" style="margin-right:5px;" /> @@{userwarning}@@</h3>
	<!-- TemplateEndBlock -->

	<!-- TemplateBeginBlock name="usererrors" -->
		<h3 class="usererror"><img src="@@{templatepath}@@/nuvola/16x16/actions/no.png" alt="" align="left" style="margin-right:5px;" /> @@{usererror}@@</h3>
	<!-- TemplateEndBlock -->
	
<!-- InstanceBeginEditable name="body" -->

<!--
<div class="textbox">
	<h3><img src="@@{templatepath}@@/nuvola/22x22/actions/view_bottom.png" alt="" align="left" style="margin-right:10px;" /> <a href="@@{[users.adduser]}@@" alt="add new user">Add new user</a></h3>
</div>
-->

<div class="textbox">

<h2>Aufgabenablauf bearbeiten</h2>

	<table width="100%" cellspacing="5" cellpadding="5" border="0">
	<tr>
	<td width="50%" valign="top">
		<form method="post" action="@@{[workflows.editworkflow]}@@" name="editworkflow" enctype="multipart/form-data; charset=utf-8">
		<input type="hidden" name="editworkflow[workflow_id]" value="@@{workflow_id:value}@@" />
		
        <table style="margin-bottom: 10px;" border="0" cellpadding="0" cellspacing="0">
            <tbody>
			<tr>
                <td nowrap="nowrap" valign="top" width="140"><p class="formlabel">Titel*</p></td>
                <td valign="middle"@@{workflow_name:formerror}@@><input maxlength="128" name="editworkflow[workflow_name]" value="@@{workflow_name:value}@@" class="formtext" type="text" />
				<!-- TemplateBeginBlock name="workflow_name:errormsg" -->
					<br /><span class="formerrormsg">@@{workflow_name:errormsg}@@</span>
				<!-- TemplateEndBlock -->
				</td>
            </tr>
            <tr>
                <td align="right" nowrap="nowrap" valign="top"><p class="formlabel">Beschreibung*</p></td>
                <td align="left" valign="middle"@@{workflow_description:formerror}@@><textarea rows="5" name="editworkflow[workflow_description]" class="formtext" style="height:175px;">@@{workflow_description:value}@@</textarea>
				<!-- TemplateBeginBlock name="workflow_description:errormsg" -->
					<br /><span class="formerrormsg">@@{workflow_description:errormsg}@@</span>
				<!-- TemplateEndBlock -->
				</td>
            </tr>
		</tbody>
		</table>
           <p style="text-align:center; margin-top:25px;"><img src="@@{templatepath}@@/nuvola/32x32/apps/kate.png" alt="" border="0" align="top" />
		   <input name="submit" value="Aufgabenablauf speichern" class="formbutton" type="submit" /></p>
		   <!-- TemplateBeginBlock name="warningactivetasks" -->
		   <h2 style="margin-top:50px;">Anmerkung:</h2>
		   <p>Achten Sie bitte darauf, dass Änderungen des Aufgabenablaufs direkte Auswirkungen auf noch aktive Aufgaben mit diesem Ablauf haben. Falls Sie Probleme vermeiden wollen, stellen Sie sicher, dass zuvor alle Aufgaben mit diesem Ablauf abgeschlossen wurden.</p>
		   <p class="targetwarning"><strong>Zur Zeit noch aktive Aufgaben mit diesem Aufgabenablauf: @@{workflow_count}@@</strong></p>
		   <!-- TemplateEndBlock -->
	   </form>
	</td>
	<td width="50%" valign="top">
		<div spry:region="dsWorkflowInformation dsGroupInformation">
		<div spry:state="loading"><p style="text-align:center;"><img src="@@{templatepath}@@/images/loading.gif" alt="" /></p></div>
	
		<div spry:state="ready">
			<br />
			<div spry:repeat="dsWorkflowInformation">
				<div class="textboxhalf">
					<p style="text-align:center; margin-top:15px; margin-left:10px;">
						<strong>Beschreibung:</strong> <input maxlength="256" id="inputfield_{dsWorkflowInformation::workflowaction_order}" value="{dsWorkflowInformation::workflowaction_title}" class="formtext" type="text" onchange="updateWorkflow('storedata', '{dsWorkflowInformation::workflowaction_order}')" />
					</p>

					<p style="text-align:center; margin-top:20px; margin-left:10px;"><strong>Zuständige Gruppe:</strong>
						<select id="dropdownfield_{dsWorkflowInformation::workflowaction_order}" name="dropdownfield_{dsWorkflowInformation::workflowaction_order}" class="formtext" spry:repeatChildren="dsGroupInformation" onchange="updateWorkflow('storedata', '{dsWorkflowInformation::workflowaction_order}')">
							<option spry:if="{dsGroupInformation::group_id} == {dsWorkflowInformation::workflowaction_group}" value="{dsGroupInformation::group_id}" selected="selected">{dsGroupInformation::group_name}</option>
							<option spry:if="{dsGroupInformation::group_id} != {dsWorkflowInformation::workflowaction_group}" value="{dsGroupInformation::group_id}">{dsGroupInformation::group_name}</option>
						</select>
					</p>

					<p style="margin-top:10px; text-align:center;">
						<span onmousemove="showTooltip('Im Aufgabenablauf nach oben', event);" onmouseout="hideTooltip();"><img src="@@{templatepath}@@/nuvola/22x22/actions/up.png" alt="Im Aufgabenablauf nach oben" border="0" onclick="updateWorkflow('stepup', '{dsWorkflowInformation::workflowaction_order}')" /></span>
						<span style="margin-left:10px;" onmousemove="showTooltip('Im Aufgabenablauf nach unten', event);" onmouseout="hideTooltip();"><img src="@@{templatepath}@@/nuvola/22x22/actions/down.png" alt="Im Aufgabenablauf nach unten" border="0" onclick="updateWorkflow('stepdown', '{dsWorkflowInformation::workflowaction_order}')" /></span>
						<span style="margin-left:10px;" onmousemove="showTooltip('Diesen Schritt löschen', event);" onmouseout="hideTooltip();"><img src="@@{templatepath}@@/nuvola/22x22/filesystems/trashcan_full.png" alt="Diesen Schritt löschen" border="0" onclick="deleteStep('{dsWorkflowInformation::workflowaction_order}', '{dsWorkflowInformation::workflowaction_title}')" /></span>
					</p>
				</div>
				<p style="margin-top:10px; margin-right:50px; text-align:center;">
					<img src="@@{templatepath}@@/nuvola/48x48/apps/download_manager.png" alt="" border="0" align="top" />
					<span style="margin-left:20px;" onmousemove="showTooltip('Weiteren Schritt hinzufügen', event);" onmouseout="hideTooltip();"><img src="@@{templatepath}@@/nuvola/22x22/actions/edit_add.png" alt="" border="0" align="top" onclick="updateWorkflow('newstep', '{dsWorkflowInformation::workflowaction_order}')" /></span>
					
				</p>
			</div>
			<div class="textboxhalf">
			<h2 style="text-align:center;">Archiv</h2>
			</div>
		</div>
		</div>

	</td>
	</tr>
	</table>

</div>

<!-- InstanceEndEditable -->

</div>
<div class="copyright">@@{versioninfo}@@</div>

</body>
<!-- InstanceEnd --></html>
