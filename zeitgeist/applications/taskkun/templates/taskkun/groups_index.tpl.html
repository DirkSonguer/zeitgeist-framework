<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/admin.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- InstanceBeginEditable name="doctitle" -->
<title>Taskkun - @@{documenttitle}@@</title>
<!-- InstanceEndEditable -->

<link rel="stylesheet" type="text/css" href="@@{templatepath}@@/css/taskkun.css" />

<script language="javascript" type="text/javascript">

	function showTooltip(text, event)
	{
		document.getElementById('Tooltip').innerHTML = text;

		var topPixel = event.clientY + 10;
		var leftPixel = event.clientX + 10;

		x = (document.all) ? window.event.x + document.body.scrollLeft + 180: event.pageX;
		y = (document.all) ? window.event.y : event.pageY;
		document.getElementById('Tooltip').style.left = (x + 20) + "px";
		document.getElementById('Tooltip').style.top = (y + 20) + "px";
		document.getElementById('Tooltip').style.display = "block";
	}

	function hideTooltip()
	{
		document.getElementById('Tooltip').innerHTML = "";

		document.getElementById('Tooltip').style.top = "0px";
		document.getElementById('Tooltip').style.left = "0px";
		document.getElementById('Tooltip').style.display = "none";
	}

</script>
	
<!-- InstanceBeginEditable name="head" -->

	<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryData.js"></script>
	<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/Spry/xpath.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryNestedXMLDataSet.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryCollapsiblePanel.js"></script>
	<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryAccordion.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/js/SpryExtensions.js"></script>

	<script type="text/javascript">

		var dsGroups = new Spry.Data.XMLDataSet("@@{[dataserver.getgroups]}@@", "container/element");
		
		function deleteGroup(id, count, name)
		{
			if (count > 0)
			{
				alert("Sie können keine Gruppe löschen, die noch aktiv in Aufgabenabläufen genutzt wird.\nBitte entfernen Sie zunächst die Gruppe aus allen Aufgabenabläufen.");
				return;
			}
			
			var answer = window.confirm("Wollen Sie die Gruppe '" + name + "' wirklich löschen?");

			if (answer == true)
			{
			   window.location.href = "@@{[groups.deletegroup]}@@"+"&id="+id;
			}
		}

	</script>

<!-- InstanceEndEditable -->
</head>

<body>

<div id="Tooltip" class="tooltip" style="display:none; text-align:left;"></div>

<div class="headmenu">
	<!-- TemplateBeginBlock name="logoutbutton" -->
	<div class="menuicon" style="float:right; margin-top:5px;">
	
	<a href="@@{[configuration.index]}@@" alt=""><span onmousemove="showTooltip('Persönliche Einstellungen', event)" onmouseout="hideTooltip()">
	<img src="@@{templatepath}@@/nuvola/48x48/apps/kcmsystem.png" alt="" border="0" /></span></a>
	
	<a href="@@{[help.index]}@@@@{helptopic}@@" alt="" target="_blank"><span onmousemove="showTooltip('Hilfe!', event)" onmouseout="hideTooltip()">
	<img src="@@{templatepath}@@/nuvola/48x48/apps/filetypes.png" alt="" border="0" /></span></a>	

	<a href="@@{[main.logout]}@@" alt=""><span onmousemove="showTooltip('Logout', event)" onmouseout="hideTooltip()">
	<img src="@@{templatepath}@@/nuvola/48x48/actions/exit.png" alt="" border="0" /></span></a>
	
	</div>
	<!-- TemplateEndBlock -->
</div>

<div class="maincontent">

<!-- TemplateBeginBlock name="navigation" -->
	<div class="headerbox">
		<div style="float:left; margin:10px;"><a href="@@{[main.index]}@@"><span onmousemove="showTooltip('Hauptseite', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/actions/gohome.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasks.index]}@@"><span onmousemove="showTooltip('Eigene Aufgaben', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/klipper.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[adhoc.index]}@@"><span onmousemove="showTooltip('Ad-Hoc-Tätigkeit eintragen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/karm.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[reports.index]}@@"><span onmousemove="showTooltip('Reports', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kchart.png" alt="" border="0" /></span></a></div>		
		
		<!-- TemplateBeginBlock name="managernavigation" -->
		<div style="float:left; margin:10px; margin-left:40px;"><a href="@@{[tasks.addtask]}@@" alt=""><span onmousemove="showTooltip('Neue Aufgabe anlegen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kword.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasks.showactivetasks]}@@" alt=""><span onmousemove="showTooltip('Alle aktiven Aufgaben anzeigen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kpager.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[search.index]}@@" alt=""><span onmousemove="showTooltip('Aktive Aufgaben suchen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kpdf.png" alt="" border="0" /></span></a></div>
		<!-- TemplateEndBlock -->

		<!-- TemplateBeginBlock name="adminnavigation" -->
		<div style="float:left; margin:10px; margin-left:40px;"><a href="@@{[users.index]}@@" alt=""><span onmousemove="showTooltip('Benutzer verwalten', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/mimetypes/vcard.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[groups.index]}@@" alt=""><span onmousemove="showTooltip('Gruppen verwalten', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kdmconfig.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasktypes.index]}@@" alt=""><span onmousemove="showTooltip('Aufgabenabläufe verwalten', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/fsview.png" alt="" border="0" /></span></a></div>
		<!-- TemplateEndBlock -->
		
		<div style="clear:both"></div>
	</div>
<!-- TemplateEndBlock -->

<!-- InstanceBeginEditable name="pagetitle" -->
<!-- InstanceEndEditable -->

	<!-- TemplateBeginBlock name="usermessage" -->
		<h3 class="usermessage"><img src="@@{templatepath}@@/nuvola/16x16/actions/ok.png" alt="" align="left" style="margin-right:5px;" /> @@{usermessage}@@</h3>
	<!-- TemplateEndBlock -->

	<!-- TemplateBeginBlock name="userwarnings" -->
		<h3 class="userwarning"><img src="@@{templatepath}@@/nuvola/16x16/actions/messagebox_info.png" alt="" align="left" style="margin-right:5px;" /> @@{userwarning}@@</h3>
	<!-- TemplateEndBlock -->

	<!-- TemplateBeginBlock name="usererrors" -->
		<h3 class="usererror"><img src="@@{templatepath}@@/nuvola/16x16/actions/no.png" alt="" align="left" style="margin-right:5px;" /> @@{usererror}@@</h3>
	<!-- TemplateEndBlock -->
	
<!-- InstanceBeginEditable name="body" -->

<!--
<div class="textbox">
	<h3><img src="@@{templatepath}@@/nuvola/22x22/actions/view_bottom.png" alt="" align="left" style="margin-right:10px;" /> <a href="@@{[users.adduser]}@@" alt="add new user">Add new user</a></h3>
</div>
-->

	<div class="textbox">
		<h3><img src="@@{templatepath}@@/nuvola/22x22/actions/view_bottom.png" alt="" align="left" style="margin-right:10px;" /> <a href="@@{[groups.addgroup]}@@" alt="Neue Gruppe hinzufügen">Neue Gruppe hinzufügen</a></h3>
	</div>
	
	<div class="textbox">
	<h2>Gruppen verwalten</h2>
	
		<div spry:region="dsGroups">
		<div spry:state="loading"><p style="text-align:center;"><img src="@@{templatepath}@@/images/loading.gif" alt="" /></p></div>
	
		<div spry:state="ready">

			<table border="0" cellspacing="0" cellpadding="0" width="100%" class="activetasks">
				<tr class="tablehead">
					<th width="300"><p><a onclick="dsGroups.sort('group_name');" class="sortlink">Name</a></p></th>
					<th><p><a onclick="dsGroups.sort('group_description');" class="sortlink">Beschreibung</a></p></th>
					<th width="180"><p style="text-align:center;"><a onclick="dsGroups.sort('group_usercount');" class="sortlink">Benutzer in<br />dieser Gruppe</a></p></th>
					<th width="180"><p style="text-align:center;"><a onclick="dsGroups.sort('group_tasktypecount');" class="sortlink">Aufgabenabläufe<br />mit dieser Gruppe</a></p></th>
				</tr>
			</table>
		
			<div id="TaskOverview" class="Accordion" tabindex="0">
				<div spry:repeat="dsGroups" class="{ds_EvenOddRow}">
					<div class="AccordionPanelTab">
		
						<table border="0" cellspacing="0" cellpadding="0" width="100%" class="activetasks">
							<tr>
								<td width="300"><p>{dsGroups::group_name}</p></td>
								<td><p>{dsGroups::group_description}</p></td>
								<td width="180"><p style="text-align:center;">{dsGroups::group_usercount}</p></td>
								<td width="180"><p style="text-align:center;">{dsGroups::group_tasktypecount}</p></td>
							</tr>
						</table>
					</div>
					
					<div class="AccordionPanelContent">
						<form method="post" action="@@{[groups.editgroup]}@@" name="edittask" enctype="multipart/form-data; charset=utf-8">
						<input type="hidden" name="editgroup[group_id]" value="{dsGroups::group_id}" />

						<br />
						<div class="textbox">
							<h2>Gruppe bearbeiten</h2>
							<table width="100%" cellspacing="5" cellpadding="5" border="0">
							<tbody>
								<tr>
									<td nowrap="nowrap" valign="top" width="160"><p class="formlabel">Name*</p></td>
									<td valign="middle"@@{group_name:formerror}@@>
										<input maxlength="128" name="editgroup[group_name]" value="{dsGroups::group_name}" class="formtext" style="width:700px;" type="text" />
										<!-- TemplateBeginBlock name="group_name:errormsg" -->
											<br /><span class="formerrormsg">@@{group_name:errormsg}@@</span>
										<!-- TemplateEndBlock -->
									</td>
								</tr>
								<tr>
									<td align="right" nowrap="nowrap" valign="top"><p class="formlabel">Beschreibung*</p></td>
									<td align="left" valign="middle"@@{group_description:formerror}@@>
										<textarea rows="5" name="editgroup[group_description]" class="formtext" style="height:175px;width:700px;">{dsGroups::group_description}</textarea>
										<!-- TemplateBeginBlock name="task_description:errormsg" -->
											<br /><span class="formerrormsg">@@{group_description:errormsg}@@</span>
										<!-- TemplateEndBlock -->
									</td>
								</tr>
							</tbody>
							</table>

							<table width="100%" cellspacing="0" cellpadding="0" border="0" style="margin-left:30px; margin-right:30px; margin-bottom:10px;">
							<tr>
								<td>
								   <p style="text-align:center;"><img src="@@{templatepath}@@/nuvola/32x32/filesystems/trashcan_full.png" alt="" border="0" align="top" />
								   <input value="Gruppe löschen" class="formbutton" type="button" onclick="deleteGroup({dsGroups::group_id}, {dsGroups::group_tasktypecount}, '{dsGroups::group_name}');" /></p>
								</td>
								<td>
								   <p style="text-align:center;"><img src="@@{templatepath}@@/nuvola/32x32/apps/kate.png" alt="" border="0" align="top" />
								   <input name="submit" value="Änderungen speichern" class="formbutton" type="submit" /></p>
								</td>
							</tr>
							</table>

						</div>
						<br />
						
						</form>

					</div>
				</div>							
			</div>

			<script type="text/javascript">
				var a1 = new Spry.Widget.Accordion("TaskOverview", { useFixedPanelHeights: false, defaultPanel: -1, enableAnimation:false });
			</script>			
		</div>
		</div>
	</div>

<!-- InstanceEndEditable -->

</div>
<div class="copyright">@@{versioninfo}@@</div>

</body>
<!-- InstanceEnd --></html>
