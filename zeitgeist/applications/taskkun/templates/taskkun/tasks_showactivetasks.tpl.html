<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/admin.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- InstanceBeginEditable name="doctitle" -->
<title>Taskkun - @@{documenttitle}@@</title>
<!-- InstanceEndEditable -->

<link rel="stylesheet" type="text/css" href="@@{templatepath}@@/css/taskkun.css" />

<script language="javascript" type="text/javascript">

	function showTooltip(text, event)
	{
		document.getElementById('Tooltip').innerHTML = text;

		var topPixel = event.clientY + 10;
		var leftPixel = event.clientX + 10;

		x = (document.all) ? window.event.x + document.body.scrollLeft + 180: event.pageX;
		y = (document.all) ? window.event.y : event.pageY;
		document.getElementById('Tooltip').style.left = (x + 20) + "px";
		document.getElementById('Tooltip').style.top = (y + 20) + "px";
		document.getElementById('Tooltip').style.display = "block";
	}

	function hideTooltip()
	{
		document.getElementById('Tooltip').innerHTML = "";

		document.getElementById('Tooltip').style.top = "0px";
		document.getElementById('Tooltip').style.left = "0px";
		document.getElementById('Tooltip').style.display = "none";
	}

</script>
	
<!-- InstanceBeginEditable name="head" -->

	<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryData.js"></script>
	<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/Spry/xpath.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryNestedXMLDataSet.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryCollapsiblePanel.js"></script>
	<script language="JavaScript" type="text/javascript" src="@@{templatepath}@@/Spry/SpryAccordion.js"></script>
	<script language="Javascript" type="text/javascript" src="@@{templatepath}@@/js/SpryExtensions.js"></script>

	<script type="text/javascript">

		var dsTasks = new Spry.Data.XMLDataSet("@@{[dataserver.getactivetasks]}@@", "container/element");
		dsTasks.setColumnType("task_id", "number");
		dsTasks.setColumnType("task_hoursplanned", "number");
		dsTasks.setColumnType("task_hoursworked", "number");

		var dsUsergroups = new Spry.Data.XMLDataSet("@@{[dataserver.getusergroups]}@@", "container/element");

		function insertData(dataElement, dataContent)
		{
			document.getElementById(dataElement).innerHTML = dataContent;
		}
	
		function taskDetails(id, name)
		{
		   window.location.href = "@@{[tasks.taskdetails]}@@"+"&id="+id;
		}
		
		function editTask(id)
		{
		   window.location.href = "@@{[tasks.edittask]}@@"+"&id="+id;
		}
					
		function deleteTask(id, name)
		{
			var answer = window.confirm("Wollen Sie die Aufgabe '" + name + "' wirklich löschen?\nHinweis: Die Aufgabe wird unwiederbringlich aus dem System entfernt!");

			if (answer == true)
			{
			   window.location.href = "@@{[tasks.deletetask]}@@"+"&id="+id;
			}
		}

		function filterGroup()
		{
			filterParameter = document.getElementById('filter_group').value;
			filterSpryDataset('group_id', filterParameter, dsTasks, false);
		}
		
		function filterPriority()
		{
			filterParameter = document.getElementById('filter_priority').value;
			filterSpryDataset('task_priority', filterParameter, dsTasks, false);
		}

		function filterHours()
		{
			filterParameter = document.getElementById('filter_hours').value;
			filterSpryDataset('task_overdrawn', filterParameter, dsTasks, false);
		}

		function filterDate()
		{
			filterParameter = document.getElementById('filter_date').value;
			filterSpryDataset('task_late', filterParameter, dsTasks, false);
		}
		
	</script>

<!-- InstanceEndEditable -->
</head>

<body>

<div id="Tooltip" class="tooltip" style="display:none; text-align:left;"></div>

<div class="headmenu">
	<!-- TemplateBeginBlock name="logoutbutton" -->
	<div class="menuicon" style="float:right; margin-top:5px;"><a href="@@{[main.logout]}@@" alt=""><span onmousemove="showTooltip('Logout', event)" onmouseout="hideTooltip()">
	<img src="@@{templatepath}@@/nuvola/48x48/actions/exit.png" alt="" align="left" border="0" /></span></a></div>
	<!-- TemplateEndBlock -->
</div>

<div class="maincontent">

<!-- TemplateBeginBlock name="navigation" -->
	<div class="headerbox">
		<div style="float:left; margin:10px;"><a href="@@{[main.index]}@@"><span onmousemove="showTooltip('Hauptseite', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/actions/gohome.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasks.index]}@@"><span onmousemove="showTooltip('Eigene Aufgaben', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/klipper.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[adhoc.index]}@@"><span onmousemove="showTooltip('Ad-Hoc-Tätigkeit eintragen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/karm.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[reports.index]}@@"><span onmousemove="showTooltip('Reports', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kchart.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[configuration.index]}@@"><span onmousemove="showTooltip('Persönliche Einstellungen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kcmsystem.png" alt="" border="0" /></span></a></div>
		<div style="float:right; margin:10px;"><a href="@@{[help.index]}@@"><span onmousemove="showTooltip('Hilfe!', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/filetypes.png" alt="" border="0" /></span></a></div>
		
		
		<!-- TemplateBeginBlock name="managernavigation" -->
		<div style="float:left; margin:10px; margin-left:40px;"><a href="@@{[tasks.addtask]}@@" alt=""><span onmousemove="showTooltip('Neue Aufgabe anlegen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kword.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasks.showactivetasks]}@@" alt=""><span onmousemove="showTooltip('Alle aktiven Aufgaben anzeigen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kpager.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[search.index]}@@" alt=""><span onmousemove="showTooltip('Aktive Aufgaben suchen', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kpdf.png" alt="" border="0" /></span></a></div>
		<!-- TemplateEndBlock -->

		<!-- TemplateBeginBlock name="adminnavigation" -->
		<div style="float:left; margin:10px; margin-left:40px;"><a href="@@{[users.index]}@@" alt=""><span onmousemove="showTooltip('Benutzer verwalten', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/mimetypes/vcard.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[usergroups.index]}@@" alt=""><span onmousemove="showTooltip('Benutzergruppen verwalten', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/kdmconfig.png" alt="" border="0" /></span></a></div>
		<div style="float:left; margin:10px;"><a href="@@{[tasktypes.index]}@@" alt=""><span onmousemove="showTooltip('Aufgabenabläufe verwalten', event)" onmouseout="hideTooltip()">
		<img src="@@{templatepath}@@/nuvola/48x48/apps/fsview.png" alt="" border="0" /></span></a></div>
		<!-- TemplateEndBlock -->
		
		<div style="clear:both"></div>
	</div>
<!-- TemplateEndBlock -->

<!-- InstanceBeginEditable name="pagetitle" -->

<!-- InstanceEndEditable -->

	<!-- TemplateBeginBlock name="usermessage" -->
		<h3 class="usermessage"><img src="@@{templatepath}@@/nuvola/16x16/actions/ok.png" alt="" align="left" style="margin-right:5px;" /> @@{usermessage}@@</h3>
	<!-- TemplateEndBlock -->

	<!-- TemplateBeginBlock name="userwarnings" -->
		<h3 class="userwarning"><img src="@@{templatepath}@@/nuvola/16x16/actions/messagebox_info.png" alt="" align="left" style="margin-right:5px;" /> @@{userwarning}@@</h3>
	<!-- TemplateEndBlock -->

	<!-- TemplateBeginBlock name="usererrors" -->
		<h3 class="usererror"><img src="@@{templatepath}@@/nuvola/16x16/actions/no.png" alt="" align="left" style="margin-right:5px;" /> @@{usererror}@@</h3>
	<!-- TemplateEndBlock -->
	
<!-- InstanceBeginEditable name="body" -->


<div id="OutputFilter" class="CollapsiblePanel, textbox">
	<div class="CollapsiblePanelTab">
		<h2 style="text-align:left; background:#B5BD82; padding:5px;">Filter anwenden
		<span style="float:right; margin-top:-20px;"><img src="@@{templatepath}@@/nuvola/22x22/actions/1uparrow.png" alt="" name="groupIcon" align="left" border="0" /><img src="@@{templatepath}@@/nuvola/22x22/actions/1downarrow.png" alt="" name="groupIcon" align="left" border="0" /></span>
		</h2>
	</div>

	<div class="CollapsiblePanelContent">
		<form name="formFilter" method="post" action="#">
		<table border="0" cellpadding="0" cellspacing="0" cellpadding="0" cellspacing="0" style="margin-top:0px;">
			<tr>
				<td width="130" valign="top" rowspan="4">
					<p><img src="@@{templatepath}@@/nuvola/128x128/apps/kghostview.png" alt="Aufgaben filtern" border="0" /></p>
				</td>
				<td align="left" valign="middle">
					<p class="formlabel">Zuständigkeit</p>
				</td>
				<td align="left" valign="middle">
					<div spry:region="dsUsergroups">
					<select id="filter_group" class="formtext" style="width:300px;" onchange="filterGroup()">
							<option value="-1">Alle anzeigen</option>
						<option spry:repeat="dsUsergroups" value="{group_id}">{group_name}</option>
						</select>
					</select>
					</div>					
				</td>
			</tr>
			<tr>
				<td align="left" valign="middle">
					<p class="formlabel">Priorität</p>
				</td>
				<td align="left" valign="middle">
					<select id="filter_priority" class="formtext" style="width:300px;" onchange="filterPriority()">
						<option value="-1">Alle anzeigen</option>
						<option value="1">Niedrig</option>
						<option value="2">Normal</option>
						<option value="3">Hoch</option>
					</select>
				</td>
			</tr>
			<tr>
				<td align="left" valign="middle">
					<p class="formlabel">Stundenlimit</p>
				</td>
				<td align="left" valign="middle">
					<select id="filter_hours" class="formtext" style="width:300px;" onchange="filterHours()">
						<option value="">Alle anzeigen</option>
						<option value="0">Aufgaben im Stundenlimit</option>
						<option value="2">Aufgaben über dem Stundenlimit</option>
					</select>
				</td>
			</tr>
			<tr>
				<td align="left" valign="middle">
					<p class="formlabel">Zeitlimit</p>
				</td>
				<td align="left" valign="middle">
					<select id="filter_date" class="formtext" style="width:300px;" onchange="filterDate()">
						<option value="">Alle anzeigen</option>
						<option value="0">Aufgaben im Zeitlimit</option>
						<option value="1">Heute fällige Aufgaben</option>
						<option value="2">Aufgaben über dem Zeitlimit</option>
					</select>
				</td>
			</tr>
		</table>
		</form>
	</div>
</div>


<div class="textbox">
	<h2>Alle aktiven Aufgaben (<span id="groupRows">2</span>)</h2>

	<div spry:region="dsTasks">
		<div spry:state="loading"><p style="text-align:center;"><img src="@@{templatepath}@@/images/loading.gif" alt="" /></p></div>
	
		<div spry:state="ready">
	
			<script type="text/javascript">
				var numRows = dsTasks.getRowCount();
				insertData('groupRows', numRows);
			</script>
			
			<table border="0" cellspacing="0" cellpadding="0" class="activetasks">
				<tr class="tablehead">
					<th style="width:30px;"><p><a onclick="dsTasks.sort('task_priority');" class="sortlink">P</a></p></th>
					<th><p><a onclick="dsTasks.sort('task_name');" class="sortlink">Aufgabe</a></p></th>
					<th style="width:150px;"><p style="text-align:center;"><a onclick="dsTasks.sort('task_hoursplanned');" class="sortlink">Stundenbudget<br />(verbraucht)</a></p></th>
					<th style="width:150px;"><p style="text-align:center;"><a onclick="dsTasks.sort('task_end');" class="sortlink">Fällig am</a></p></th>
					<th style="width:120px;"><p class="thtext">Aktionen</p></th>
				</tr>
			</table>
			
			<div id="TaskOverview" class="Accordion" tabindex="0">
				<div spry:repeat="dsTasks" class="{ds_EvenOddRow}">
					<div class="AccordionPanelTab">

						<table border="0" cellspacing="0" cellpadding="0" class="activetasks">
						<tr>
							<td style="width:30px;"><p class="ptable">
								<span spry:if="{dsTasks::task_priority} == '1'"><span onmousemove="showTooltip('Niedrige Priorität', event)" onmouseout="hideTooltip()"><img src="@@{templatepath}@@/nuvola/22x22/actions/down.png" alt="Niedrige Priorität" border="0" /></span></span>
								<span spry:if="{dsTasks::task_priority} == '2'"></span>
								<span spry:if="{dsTasks::task_priority} == '3'"><span onmousemove="showTooltip('Hohe Priorität', event)" onmouseout="hideTooltip()"><img src="@@{templatepath}@@/nuvola/22x22/actions/up.png" alt="Hohe Priorität" border="0" /></span></span>
							</p></td>		
							<td><p class="ptable">{dsTasks::task_name}</p></td>
							<td style="width:150px;">
								<p spry:if="{dsTasks::task_overdrawn} == '0'" class="ptable" style="text-align:center;">{dsTasks::task_hoursplanned} ({dsTasks::task_hoursworked})</p>
								<p spry:if="{dsTasks::task_overdrawn} == '1'" class="ptable, targetwarning" style="text-align:center;">{dsTasks::task_hoursplanned} ({dsTasks::task_hoursworked})</p>
								<p spry:if="{dsTasks::task_overdrawn} == '2'" class="ptable, targeterror" style="text-align:center;">{dsTasks::task_hoursplanned} ({dsTasks::task_hoursworked})</p>
							</td>
							<td style="width:150px;">
								<div spry:choose="spry:choose">
									<div spry:when="'{dsTasks::task_end}' == '00.00.0000'"><p class="ptable" style="text-align:center;">-</p></div>
									<div spry:default="spry:default">
										<p spry:if="{dsTasks::task_late} == '0'" class="ptable" style="text-align:center;">{dsTasks::task_end}</p>
										<p spry:if="{dsTasks::task_late} == '1'" class="ptable, targetwarning" style="text-align:center;">{dsTasks::task_end}</p>
										<p spry:if="{dsTasks::task_late} == '2'" class="ptable, targeterror" style="text-align:center;">{dsTasks::task_end}</p>
									</div>
								</div>
							</td>
							<td width="120" nowrap="nowrap"><p class="ptable" style="text-align:center;">
							<span onmousemove="showTooltip('Details', event)" onmouseout="hideTooltip()"><a href="@@{[tasks.taskdetails]}@@&id={dsTasks::task_id}" alt="Details"><img src="@@{templatepath}@@/nuvola/22x22/apps/kappfinder.png" onclick="taskDetails({dsTasks::task_id});" alt="Details" border="0" /></a></span> &nbsp; 
							<span onmousemove="showTooltip('Aufgabe bearbeiten', event)" onmouseout="hideTooltip()"><a href="@@{[tasks.edittask]}@@&id={dsTasks::task_id}" alt="Aufgabe bearbeiten"><img src="@@{templatepath}@@/nuvola/22x22/actions/pencil.png" onclick="editTask({dsTasks::task_id});" alt="Aufgabe bearbeiten" border="0" /></a></span> &nbsp; 
							<span onmousemove="showTooltip('Aufgabe löschen', event)" onmouseout="hideTooltip()"><a href="javascript:deleteTask({dsTasks::task_id}, '{dsTasks::task_name}')" alt="Aufgabe löschen"><img src="@@{templatepath}@@/nuvola/22x22/filesystems/trashcan_full.png" onclick="deleteTask({dsTasks::task_id}, '{dsTasks::task_name}');" alt="Aufgabe löschen" border="0" /></a></span>
							</p></td>
						</tr>
						</table>				
					
					</div>
					
					<div class="AccordionPanelContent">
					
						<table border="0" cellspacing="0" cellpadding="0" class="activetasks" style="margin-bottom:10px;">
						<tr>
							<td style="width:30px;">&nbsp;</td>
							<td valign="top">							
								<div spry:choose="spry:choose">
									<div spry:when="'{dsTasks::user_username}' == ''"><p class="ptable"><strong>Zuständige Gruppe:</strong> {dsTasks::group_name}</p></div>
									<div spry:default="spry:default">
										<p class="ptable"><strong>Zuständig:</strong> {dsTasks::user_username}</p>
									</div>
								</div>
							</td>
						</tr>
						<tr>
							<td style="width:30px;">&nbsp;</td>
							<td valign="top">							
								<p class="ptable"><strong>Beschreibung:</strong> {dsTasks::task_description}</p>
							</td>
						</tr>
						</table>
						
					</div>
				</div>
			</div>
	
			<script type="text/javascript">
				var a1 = new Spry.Widget.Accordion("TaskOverview", { useFixedPanelHeights: false, defaultPanel: -1, enableAnimation:false });
			</script>
	
		</div>
	</div>
	
</div>

<script type="text/javascript">
	var OutputFilter = new Spry.Widget.CollapsiblePanel("OutputFilter", {contentIsOpen:false});
</script> 

<!-- InstanceEndEditable -->

</div>
<div class="copyright">@@{versioninfo}@@</div>

</body>
<!-- InstanceEnd --></html>
